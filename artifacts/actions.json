{
  "actions": [
    {
      "context": [
        {
          "kind": "decision-task"
        },
        {
          "kind": "action-callback"
        },
        {
          "kind": "cron-task"
        }
      ],
      "description": "Create a clone of the task (retriggering decision, action, and cron tasks requires\nspecial scopes).",
      "extra": {
        "actionPerm": "generic"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-generic/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "retrigger-decision",
            "description": "Create a clone of the task (retriggering decision, action, and cron tasks requires\nspecial scopes).",
            "name": "retrigger",
            "symbol": "rt",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Retrigger"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "retrigger",
      "title": "Retrigger"
    },
    {
      "context": [
        {
          "retrigger": "true"
        }
      ],
      "description": "Create a clone of the task.",
      "extra": {
        "actionPerm": "generic"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-generic/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "retrigger",
            "description": "Create a clone of the task.",
            "name": "retrigger",
            "symbol": "rt",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Retrigger"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "retrigger",
      "schema": {
        "properties": {
          "downstream": {
            "default": false,
            "description": "If true, downstream tasks from this one will be cloned as well. The dependencies will be updated to work with the new task at the root.",
            "type": "boolean"
          },
          "times": {
            "default": 1,
            "description": "How many times to run each task.",
            "maximum": 100,
            "minimum": 1,
            "title": "Times",
            "type": "integer"
          }
        },
        "type": "object"
      },
      "title": "Retrigger"
    },
    {
      "context": [
        {}
      ],
      "description": "Create a clone of the task.\n\nThis type of task should typically be re-run instead of re-triggered.",
      "extra": {
        "actionPerm": "generic"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-generic/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "retrigger-disabled",
            "description": "Create a clone of the task.\n\nThis type of task should typically be re-run instead of re-triggered.",
            "name": "retrigger",
            "symbol": "rt",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Retrigger (disabled)"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "retrigger",
      "schema": {
        "properties": {
          "downstream": {
            "default": false,
            "description": "If true, downstream tasks from this one will be cloned as well. The dependencies will be updated to work with the new task at the root.",
            "type": "boolean"
          },
          "force": {
            "default": false,
            "description": "This task should not be re-triggered. This can be overridden by passing `true` here.",
            "type": "boolean"
          },
          "times": {
            "default": 1,
            "description": "How many times to run each task.",
            "maximum": 100,
            "minimum": 1,
            "title": "Times",
            "type": "integer"
          }
        },
        "type": "object"
      },
      "title": "Retrigger (disabled)"
    },
    {
      "context": [],
      "description": "Add new jobs using task labels.",
      "extra": {
        "actionPerm": "generic"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-generic/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "add-new-jobs",
            "description": "Add new jobs using task labels.",
            "name": "add-new-jobs",
            "symbol": "add-new",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Add new jobs"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "add-new-jobs",
      "schema": {
        "properties": {
          "tasks": {
            "description": "An array of task labels",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "times": {
            "default": 1,
            "description": "How many times to run each task.",
            "maximum": 100,
            "minimum": 1,
            "title": "Times",
            "type": "integer"
          }
        },
        "type": "object"
      },
      "title": "Add new jobs"
    },
    {
      "context": [
        {}
      ],
      "description": "Rerun a task.\n\nThis only works on failed or exception tasks in the original taskgraph, and is CoT friendly.",
      "extra": {
        "actionPerm": "generic"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-generic/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "rerun",
            "description": "Rerun a task.\n\nThis only works on failed or exception tasks in the original taskgraph, and is CoT friendly.",
            "name": "rerun",
            "symbol": "rr",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Rerun"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "rerun",
      "schema": {
        "properties": {},
        "type": "object"
      },
      "title": "Rerun"
    },
    {
      "context": [
        {}
      ],
      "description": "Cancel the given task",
      "extra": {
        "actionPerm": "generic"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-generic/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "cancel",
            "description": "Cancel the given task",
            "name": "cancel",
            "symbol": "cx",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Cancel Task"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "cancel",
      "title": "Cancel Task"
    },
    {
      "context": [],
      "description": "Cancel all running and pending tasks created by the decision task this action task is associated with.",
      "extra": {
        "actionPerm": "generic"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-generic/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "cancel-all",
            "description": "Cancel all running and pending tasks created by the decision task this action task is associated with.",
            "name": "cancel-all",
            "symbol": "cAll",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Cancel All"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "cancel-all",
      "title": "Cancel All"
    },
    {
      "context": [],
      "description": "Initiate part or all of the training pipeline",
      "extra": {
        "actionPerm": "train"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-train/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "train",
            "description": "Initiate part or all of the training pipeline",
            "name": "train",
            "symbol": "train",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Train"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "train",
      "schema": {
        "properties": {
          "datasets": {
            "default": {
              "devtest": [
                "flores_dev",
                "sacrebleu_wmt19"
              ],
              "mono-src": [
                "news-crawl_news.2020"
              ],
              "mono-trg": [
                "news-crawl_news.2020"
              ],
              "test": [
                "flores_devtest",
                "sacrebleu_wmt20"
              ],
              "train": [
                "opus_ada83/v1",
                "opus_GNOME/v1",
                "mtdata_Neulab-tedtalks_train-1-eng-rus"
              ]
            },
            "description": "The datasets to train with",
            "properties": {
              "devtest": {
                "description": "datasets to merge for validation while training",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "mono-src": {
                "description": "\nmonolingual datasets (ex. paracrawl-mono_paracrawl8, commoncrawl_wmt16, news-crawl_news.2020)\nto be translated by the teacher model\n",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "mono-trg": {
                "description": "\nto be translated by the backward model to augment teacher corpus with back-translations\nleave empty to skip augmentation step (high resource languages)\n",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "test": {
                "description": "datasets for evaluation",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "train": {
                "description": "Parallel training corpus",
                "items": {
                  "type": "string"
                },
                "type": "array"
              }
            },
            "type": "object"
          },
          "experiment": {
            "default": {
              "backward-model": "NOT-YET-SUPPORTED",
              "best-model": "chrf",
              "bicleaner": {
                "dataset-thresholds": {
                  "mtdata_Neulab-tedtalks_train-1-eng-rus": 0.6,
                  "opus_ada83/v1": 0.0
                },
                "default-threshold": 0.5
              },
              "mono-max-sentences-src": 100000,
              "mono-max-sentences-trg": 200000,
              "name": "training pipeline test config",
              "split-length": 100000,
              "spm-sample-size": 100000,
              "src": "ru",
              "teacher-ensemble": 2,
              "trg": "en",
              "vocab": "NOT-YET-SUPPORTED"
            },
            "properties": {
              "backward-model": {
                "description": "???",
                "type": "string"
              },
              "best-model": {
                "description": "best model to use for training",
                "type": "string"
              },
              "bicleaner": {
                "properties": {
                  "dataset-thresholds": {
                    "additionalProperties": {
                      "type": "number"
                    },
                    "type": "object"
                  },
                  "default-threshold": {
                    "description": "bicleaner threshold",
                    "type": "number"
                  }
                },
                "required": [
                  "default-threshold"
                ]
              },
              "mono-max-sentences-src": {
                "description": "limits per downloaded src dataset",
                "type": "number"
              },
              "mono-max-sentences-trg": {
                "description": "limits per downloaded trg dataset",
                "type": "number"
              },
              "name": {
                "description": "A name for the experiment",
                "type": "string"
              },
              "split-length": {
                "description": "???",
                "type": "number"
              },
              "spm-sample-size": {
                "description": "vocabularly training sample size",
                "type": "number"
              },
              "src": {
                "description": "The src locale to train",
                "type": "string"
              },
              "teacher-ensemble": {
                "description": "Number of teachers to train",
                "type": "number"
              },
              "trg": {
                "description": "The trg locale to train",
                "type": "string"
              },
              "vocab": {
                "description": "???",
                "type": "string"
              }
            },
            "required": [
              "name",
              "src",
              "trg",
              "bicleaner"
            ],
            "type": "object"
          },
          "marian-args": {
            "default": {
              "decoding-backward": {
                "mini-batch-words": "2000"
              },
              "decoding-teacher": {
                "mini-batch-words": "1000",
                "precision": "float16"
              },
              "training-backward": {
                "after": "500u",
                "disp-freq": "10",
                "save-freq": "100",
                "valid-freq": "100"
              },
              "training-student": {
                "after": "500u",
                "disp-freq": "10",
                "save-freq": "100",
                "valid-freq": "100"
              },
              "training-student-finetuned": {
                "after": "500u",
                "disp-freq": "10",
                "save-freq": "100",
                "valid-freq": "100"
              },
              "training-teacher-base": {
                "after": "500u",
                "disp-freq": "10",
                "save-freq": "100",
                "valid-freq": "100"
              },
              "training-teacher-finetuned": {
                "after": "500u",
                "disp-freq": "10",
                "save-freq": "100",
                "valid-freq": "100"
              }
            },
            "properties": {
              "decoding-backward": {
                "additionalProperties": {
                  "type": "string"
                },
                "type": "object"
              },
              "decoding-teacher": {
                "additionalProperties": {
                  "type": "string"
                },
                "type": "object"
              },
              "training-backward": {
                "additionalProperties": {
                  "type": "string"
                },
                "type": "object"
              },
              "training-student": {
                "additionalProperties": {
                  "type": "string"
                },
                "type": "object"
              },
              "training-student-finetuned": {
                "additionalProperties": {
                  "type": "string"
                },
                "type": "object"
              },
              "training-teacher-base": {
                "additionalProperties": {
                  "type": "string"
                },
                "type": "object"
              },
              "training-teacher-finetuned": {
                "additionalProperties": {
                  "type": "string"
                },
                "type": "object"
              }
            },
            "type": "object"
          },
          "target-stage": {
            "default": "all",
            "description": "The stage of the pipeline to run until\n(any stages this choice depends on will be automatically included).",
            "enum": [
              "clean-corpus",
              "clean-mono",
              "bicleaner",
              "bicleaner-ai",
              "merge-corpus",
              "merge-devset",
              "merge-mono",
              "train-vocab",
              "train-backwards",
              "evaluate-backwards",
              "split-corpus",
              "split-mono",
              "translate-mono-trg",
              "collect-mono-trg",
              "merge-augmented",
              "train-teacher",
              "evaluate-teacher",
              "finetune-teacher",
              "evaluate-finetuned-teacher",
              "translate-corpus",
              "extract-best",
              "collect-corpus",
              "translate-mono-src",
              "collect-mono-src",
              "merge-translated",
              "score",
              "cefilter",
              "alignments",
              "train-student",
              "evaluate-student",
              "finetune-student",
              "evaluate-finetuned-student",
              "quantize",
              "evaluate-quantized",
              "export",
              "evaluate-teacher-ensemble",
              "all"
            ],
            "type": "string"
          },
          "taskcluster": {
            "default": {
              "split-chunks": 10
            },
            "description": "Taskcluster-specific pipeline configuration, eg: chunking",
            "properties": {
              "split-chunks": {
                "description": "The number of chunks (parallel jobs) to use in `split` steps",
                "type": "number"
              }
            },
            "type": "object"
          }
        },
        "required": [
          "target-stage",
          "datasets",
          "experiment",
          "marian-args"
        ],
        "type": "object"
      },
      "title": "Train"
    },
    {
      "context": [],
      "description": "Rebuild cached tasks.",
      "extra": {
        "actionPerm": "generic"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-generic/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "rebuild-cached-tasks",
            "description": "Rebuild cached tasks.",
            "name": "rebuild-cached-tasks",
            "symbol": "rebuild-cached",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Rebuild Cached Tasks"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "rebuild-cached-tasks",
      "title": "Rebuild Cached Tasks"
    },
    {
      "context": [],
      "description": "Create a clone of the task.",
      "extra": {
        "actionPerm": "generic"
      },
      "hookGroupId": "project-translations",
      "hookId": "in-tree-action-1-generic/b59097071d",
      "hookPayload": {
        "decision": {
          "action": {
            "cb_name": "retrigger-multiple",
            "description": "Create a clone of the task.",
            "name": "retrigger-multiple",
            "symbol": "rt",
            "taskGroupId": "E0XBM6FLQnCjzIk-ObZSgg",
            "title": "Retrigger"
          },
          "push": {
            "branch": "refs/heads/dev-followup",
            "owner": "mozilla-taskcluster-maintenance@mozilla.com",
            "pushlog_id": "0",
            "revision": "7617f2fbd37aa68fb81f90a58d9cb92bc1cb0cc9"
          },
          "repository": {
            "level": "1",
            "project": "staging-firefox-translations-training",
            "url": "https://github.com/mozilla-releng/staging-firefox-translations-training"
          }
        },
        "user": {
          "input": {
            "$eval": "input"
          },
          "taskGroupId": {
            "$eval": "taskGroupId"
          },
          "taskId": {
            "$eval": "taskId"
          }
        }
      },
      "kind": "hook",
      "name": "retrigger-multiple",
      "schema": {
        "properties": {
          "additionalProperties": false,
          "requests": {
            "items": {
              "additionalProperties": false,
              "tasks": {
                "description": "An array of task labels",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "times": {
                "description": "How many times to run each task.",
                "maximum": 100,
                "minimum": 1,
                "title": "Times",
                "type": "integer"
              }
            },
            "type": "array"
          }
        },
        "type": "object"
      },
      "title": "Retrigger"
    }
  ],
  "variables": {},
  "version": 1
}